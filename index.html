<!DOCTYPE html>
<html>
<head>
	<title></title>
	<link rel="stylesheet" type="text/css" href="./static/css/bootstrap.min.css">
</head>
<body>
<div id="app">
	app
	<div class="container">
			<div class="form-group">
				<label>Email</label>
				<input type="text" name="email">
			</div>
			<div class="form-group">
				<button onclick="login()">登录</button>
				<button onclick="bind()">绑定</button>
			</div>
	</div>
</div>
<script type="text/javascript" src="./static/js/vue.min.js"></script>
<script type="text/javascript" src="./static/js/ws.js"></script>
<script type="text/javascript">
	fetch("/api/user").then(function(res){
		return res.json();
	}).then(function(res){
		console.log(res)
	})
	function login(){
		var email = document.querySelector('input[name="email"]').value
		var formdata = new FormData();
			formdata.append("email",email)
		fetch("/api/login",{method:"post",body:formdata})
		.then(function(res){
			return res.json()
		})
		.then(function(res){
			uid = res.uid
		})
	}
	function bind(){
		var obj = {};
			obj.messageType = "bind";
			obj.Uid = uid;
		ws.send(JSON.stringify(obj));
	}
	//查询在线用户
	setInterval(function(){
		var obj = {}
			obj.messageType = 'online'
		ws.send(JSON.stringify(obj));
	},1000 * 55)
</script>
</body>
</html>